
ðŸ“ŒðŸ“ŒðŸ“ŒðŸ“ŒðŸ“Œ THIS FILE WILL TELL THE OVER ALL WORKING OF THE BACKEND ðŸ“ŒðŸ“ŒðŸ“ŒðŸ“ŒðŸ“Œ

    âœ… Backend Project Structure With Short Descriptions

backend/
â”‚â”€â”€ app/
â”‚   â”‚â”€â”€ main.py                # Entry point of FastAPI app (includes routes, starts server)
â”‚   â”‚â”€â”€ config.py              # Loads environment variables & application settings, but in our case its empt, directly using the config() function the variables from .env are read
â”‚   â”‚â”€â”€ database.py            # Database connection + session management
â”‚
â”‚   â”‚â”€â”€ utils/
â”‚   â”‚   â”‚â”€â”€ auth.py            # Authentication helper functions (verify user, login logic)
â”‚   â”‚   â”‚â”€â”€ hashing.py         # Password hashing & verification logic
â”‚   â”‚   â”‚â”€â”€ jwt_handler.py     # Create & validate JWT access tokens
â”‚
â”‚   â”‚â”€â”€ models/                # this MODLES are just for refence, like they just give uh a idea of what type of data uh will store, it doesnt have any connection with the APPLICATION
â”‚   â”‚   â”‚â”€â”€ user_model.py      # SQLAlchemy model for user table
â”‚   â”‚   â”‚â”€â”€ product_model.py   # SQLAlchemy model for product table
â”‚   â”‚   â”‚â”€â”€ invoice_model.py   # SQLAlchemy model for invoice table
â”‚
â”‚   â”‚â”€â”€ schemas/               # these schemas are build by seeing the models, like these scheams help uh to transfer the data betweeen the API, and also tell us what type of response the API will send, how it should look like
â”‚   â”‚   â”‚â”€â”€ user_schema.py     # Pydantic schemas for user input/output validation
â”‚   â”‚   â”‚â”€â”€ product_schema.py  # Pydantic schemas for product data validation
â”‚   â”‚   â”‚â”€â”€ invoice_schema.py  # Pydantic schemas for invoice data validation
â”‚
â”‚   â”‚â”€â”€ routers/               # in our project we havent seprated the routes, but usually we wiill separate them from the main.py and store the API routes here
â”‚   â”‚   â”‚â”€â”€ auth_router.py     # API endpoints for signup/login/authentication
â”‚   â”‚   â”‚â”€â”€ product_router.py  # API endpoints for product CRUD operations
â”‚   â”‚   â”‚â”€â”€ invoice_router.py  # API endpoints for invoice creation/listing
â”‚
â”‚   â”‚â”€â”€ services/
â”‚       â”‚â”€â”€ invoice_service.py  # Business logic for invoice creation & calculations
â”‚       â”‚â”€â”€ pdf_service.py      # Generates invoice PDF from HTML template
â”‚       â”‚â”€â”€ email_service.py    # Sends emails with attachments (PDF invoices)
â”‚       â”‚â”€â”€ product_service.py  # Business logic for product CRUD operations
â”‚       â”‚â”€â”€ storage_service.py  # Handles file uploads/storage (local or cloud)
â”‚
â”‚   â”‚â”€â”€ Templates/
â”‚       â”‚â”€â”€ invoice.html        # HTML template used to generate invoice PDF
â”‚
â”‚â”€â”€ requirements.txt            # Python dependencies for the project
â”‚â”€â”€ .env                        # Environment variables (DB URL, JWT secret, SMTP creds)
â”‚â”€â”€ .gitignore                  # Files/folders excluded from Git version control

---------------------------------------------------------------------------------------------------------------------------------------------------

ENV :First create the connectiion of databse,using the .env file

database.py : this file will connect to the mongodb cluster, using the .env file variables

main.py : this file will just start the server, and import all routes, so that the user can connect to the API, but the actual route logic is in the ROUTE folder

MODELS : these are the python class, whihc will store the actual data
    user_model : this will store the user info, like name, email, password, phone no, all sign up data feilds
    -This models will not be used for storing the actual data, they are just refrences, and the actual data will be store in the "SCHEMA" folder, where the actul schema (models only) are creaetd as per the requrenment of the FASTAPI

SCHEMA : this is the folder, in which data validations will be done, and that data will be snet to the database, but these classes wont store the data, they just represent it 

ROUTES : these are the api end points, where the user can make request from the brousser
    auth_router : this will be used for sign up and login, and this will be using the data from the user model, like username and password


UTILS : this is the code, which will be including the logic for login authentication, using the JWT token


def calculate_rent_per_day(unit_price: float, qty: int, created_at: datetime, rent_rate=RENT_RATE):
    """
    Rent calculation per item:
    - Count days the product stayed in inventory
    - Daily rent = (unit_price * qty * rent_rate)
    - Total rent = daily_rent * days
    """
    today = datetime.utcnow()

    days_in_inventory = (today - created_at).days
    if days_in_inventory < 1:
        days_in_inventory = 1  # minimum 1 day rent

    unit_total_price = unit_price * qty  # price * qty
    rent_per_day = unit_total_price * rent_rate
    total_item_rent = rent_per_day * days_in_inventory

    return {
        "days_in_inventory": days_in_inventory,
        "unit_total_price": round(unit_total_price),
        "rent_per_day": round(rent_per_day),
        "total_item_rent": round(total_item_rent)
    }

-----------------------------------------------------------------------------------------------

ðŸ“Œ MAIN APPLICATION LEVEL
1ï¸âƒ£ main.py
Short: Entry point of FastAPI; loads app, includes routers, runs server.
Detailed Purpose: Creates the FastAPI() app instance. Includes all routers from routers/ folder. Initializes database connection on startup. The request flow starts here â†’ router â†’ service â†’ database.

2ï¸âƒ£ config.py
Short: Loads environment variables and application settings.
Detailed Purpose: Reads .env file. Stores config like DATABASE_URL, JWT secret, email creds. Makes settings reusable across whole project.

3ï¸âƒ£ database.py
Short: Database connection and session management.
Detailed Purpose: Creates SQLAlchemy engine. Manages session lifecycle for each request. Ensures clean DB connections using dependency injection.

ðŸ“Œ UTILS (Helper Logic)
4ï¸âƒ£ utils/auth.py
Short: Authentication helper functions. 
Detailed Purpose: Performs user validation, login checks. Works with JWT + hashing utilities.

5ï¸âƒ£ utils/hashing.py
Short: Handle password hashing/verification.
Detailed Purpose: Uses bcrypt or passlib. Ensures passwords never stored as plain text.

6ï¸âƒ£ utils/jwt_handler.py
Short :  Create/verify JWT tokens.
Detailed Purpose: Generates access tokens on login. Validates tokens for protected routes. Stores expiration logic.

ðŸ“Œ MODELS (Database Tables)
7ï¸âƒ£ user_model.py
Short: User table structure.
Detailed Purpose: SQLAlchemy model defining columns (id, email, passwordâ€¦). Represents real DB table.

8ï¸âƒ£ product_model.py
Short: Product table structure.
Detailed Purpose: Holds product-related fields. Used by product service + invoice generation.

9ï¸âƒ£ invoice_model.py
Short: Invoice table structure.
Detailed Purpose:  Stores each invoice record (items, date, amount). Connects with user/product via relationships.

ðŸ“Œ SCHEMAS (Data Validation)
ðŸ”Ÿ user_schema.py
Short: Pydantic models for user input/output.
Detailed Purpose: Ensures data formatting before sending to DB. Used in auth routes and user creation.

1ï¸âƒ£1ï¸âƒ£ product_schema.py
Short: Validation schema for product operations.
Detailed Purpose: Controls the structure of product creation, update, response.

1ï¸âƒ£2ï¸âƒ£ invoice_schema.py
Short: Validation for invoice input/output.
Detailed Purpose: Ensures invoice data is correct before stored/returned.

ðŸ“Œ ROUTERS (Route Definitions)
Note: You said routes are inside main.py, not separated â€” so these router files are â€œfuture-readyâ€ and represent separation of concerns, even if not used yet.
1ï¸âƒ£3ï¸âƒ£ auth_router.py
Short: All endpoints for login, signup, token refresh.
Why Present: Keeps authentication logic modular. Will replace auth routes in main.py when separated.

1ï¸âƒ£4ï¸âƒ£ product_router.py
Short: All CRUD endpoints for products.
Why Present: Separates business logic from main.py. Makes code scalable and easy to maintain.

1ï¸âƒ£5ï¸âƒ£ invoice_router.py
Short: Endpoints for invoice creation, listing, retrieval.
Why Present: Routes should not stay in main.py forever. Cleaner invoice logic separation.

ðŸ“Œ SERVICES (Business Logic Layer)
1ï¸âƒ£6ï¸âƒ£ invoice_service.py
Short: Core logic to calculate & generate invoice data.
Detailed Purpose: Calculates rent/amount. Creates invoice objects and saves to DB. Returns invoice details to router.

1ï¸âƒ£7ï¸âƒ£ pdf_service.py
Short: Converts invoice data into PDF.
Detailed Purpose:Loads invoice.html template. Uses a library (like WeasyPrint/ReportLab). Produces a professional PDF.

1ï¸âƒ£8ï¸âƒ£ email_service.py
Short: Sends invoice PDF to customer.
Detailed Purpose: Uses SMTP (Gmail or other SMTP). Attaches PDF & sends email. Handles failures, retries.

1ï¸âƒ£9ï¸âƒ£ product_service.py
Short: All product-related business logic. 
Detailed Purpose:Clean separation: router â†’ service â†’ model. Product CRUD + any custom actions.

2ï¸âƒ£0ï¸âƒ£ storage_service.py
Short: Handles file storage (uploads, downloads).
Detailed Purpose: May use local disk, AWS S3, Firebase, etc. Helps to store images, documents.

ðŸ“Œ TEMPLATES
2ï¸âƒ£1ï¸âƒ£ invoice.html
Short: HTML template for invoice PDF.
Detailed Purpose: Dynamic HTML â†’ converted to PDF. Contains placeholders for name, items, amount.

ðŸ“Œ PROJECT ROOT FILES
2ï¸âƒ£2ï¸âƒ£ requirements.txt
Short:All dependencies list.
Purpose: Install project with pip install -r requirements.txt.

2ï¸âƒ£3ï¸âƒ£ .env
Short: Environment configuration.
Purpose: Stores secrets (DB URL, email keys, JWT secret). Never pushed to GitHub.

2ï¸âƒ£4ï¸âƒ£ .gitignore
Short: Files to ignore in version control.
Purpose: Prevents pushing .env, cache files, venv, PDFs.

â­ Workflow Summary (How Data Moves)
Request â†’ main.py â†’ router â†’ service â†’ model (DB) â†’ service â†’ router â†’ response
POST /invoice/create
â†’ main.py receives request
â†’ invoice_router handles route
â†’ invoice_service calculates invoice
â†’ invoice_model saves to DB
â†’ pdf_service generates PDF
â†’ email_service sends invoice mail
â†’ response returned to user
